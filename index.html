<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å°å®çš„éƒ¨è½æ ¼ | éŸ³æ¨‚ã€ç¨‹å¼èˆ‡ç”Ÿæ´»æ¢ç´¢</title>
  <meta name="description" content="æ˜Ÿå®çš„å°éƒ¨è½æ ¼ï¼Œåˆ†äº«éŸ³æ¨‚å­¸ç¿’ã€ç¨‹å¼å°ˆæ¡ˆèˆ‡ç”Ÿæ´»é»æ»´ï¼Œè®“ä½ ä¸€èµ·æ¢ç´¢å­¸ç¿’èˆ‡å‰µä½œçš„æ¨‚è¶£ã€‚">
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <link rel="icon" href="favicon192.png" type="image/png" sizes="192x192">
  <link rel="apple-touch-icon" href="favicon180.png">
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="main.css">
  <link rel="stylesheet" href="theme.css">
</head>
<body>
  <header>
    <h1>å°å®çš„éƒ¨è½æ ¼</h1>
  </header>

  <main class="container">
    <div class="spacer"></div>

    <!-- é—œæ–¼æˆ‘ -->
    <section>
      <h2>é—œæ–¼æˆ‘èˆ‡æˆ‘çš„èˆˆè¶£</h2>
      <div class="typewriter-container">
        <span id="typing-text"></span><span class="cursor" id="cursor"></span>
      </div>
      <img id="avatar" src="andrew.png" alt="æ˜Ÿå®çš„å€‹äººé ­åƒ">
    </section>

    <!-- ä»»å‹™æŒ‘æˆ° -->
    <section id="task-section" class="hidden">
      <h2>ä»»å‹™èˆ‡å¾½ç« </h2>
      <p>åœ¨å°å®ä»»å‹™æŒ‘æˆ°ä¸­å®Œæˆä»»å‹™å³å¯ç²å¾—å¾½ç« ï¼Œé€ééŠæˆ²åŒ–æ–¹å¼æå‡å­¸ç¿’æ¨‚è¶£ã€‚å®ŒæˆæŒ‘æˆ°å¾Œå¯åœ¨é¦–é æŸ¥çœ‹ä½ çš„æˆå°±ï¼Œå¢åŠ äº’å‹•èˆ‡åƒèˆ‡æ„Ÿã€‚</p>
      <button onclick="goTask()">é–‹å§‹ä»»å‹™</button>
      <button onclick="closeTask()">è¿”å›</button>
      <div id="badges">
        <h3>ä½ å·²ç²å¾—çš„å¾½ç« ï¼š</h3>
        <div id="badgeList"></div>
      </div>
    </section>

    <!-- ç¶²ç«™ç”¨é€” -->
    <section>
      <h2>ç¶²ç«™ç”¨é€”</h2>
      <p>é€™å€‹éƒ¨è½æ ¼æä¾›ç•™è¨€æ¿åŠŸèƒ½ï¼Œè®“è¨ªå®¢å¯ä»¥è‡ªç”±äº¤æµã€åˆ†äº«å­¸ç¿’å¿ƒå¾—èˆ‡ç”Ÿæ´»é»æ»´ã€‚æ‰€æœ‰ç•™è¨€éƒ½æœƒå®‰å…¨å„²å­˜åœ¨è³‡æ–™åº«ä¸­ï¼Œç¢ºä¿äº’å‹•é †æš¢åˆå®‰å…¨ã€‚</p>
    </section>

    <!-- è¯çµ¡æˆ‘ -->
    <section>
      <h2>è¯çµ¡æˆ‘èˆ‡å…¶ä»–é€£çµ</h2>
      <p>æƒ³è¦è¯çµ¡å°å®æˆ–åˆ†äº«å­¸ç¿’å¿ƒå¾—å—ï¼Ÿä½ å¯ä»¥é€éä»¥ä¸‹æ–¹å¼è¯çµ¡æˆ‘ï¼š</p>
      <p><strong>ğŸ“§ é›»å­éƒµä»¶ï¼š</strong><a href="mailto:andrewwork03295@gmail.com">andrewwork03295@gmail.com</a></p>
      <p><strong>ğŸŒ é›»å­åç‰‡ï¼š</strong><a href="https://andrew0205-ai.github.io/name" target="_blank">é›»å­åç‰‡</a></p>
      <p><strong>ğŸ“ æˆ‘çš„æ—¥è¨˜ï¼š</strong><a href="https://andrew0205blogs.blogspot.com/" target="_blank">andrew0205blogs.blogspot.com</a></p>
      <h2>åˆ‡æ›èªè¨€ Switch Language</h2>
      <button onclick="go()">English</button>
    </section>

    <!-- ç•™è¨€æ¿ -->
    <section id="comment-section" class="comment-area">
      <h2>ç•™è¨€æ¿èˆ‡äº¤æµ</h2>
      <p>æ­¡è¿åœ¨å°å®çš„éƒ¨è½æ ¼ç•™è¨€æ¿åˆ†äº«ä½ çš„æƒ³æ³•ã€å­¸ç¿’ç¶“é©—æˆ–ç”Ÿæ´»é»æ»´ï¼é€™è£¡æ˜¯ä¸€å€‹å®‰å…¨çš„äº¤æµå¹³å°ï¼Œè®“å¤§å®¶äº’ç›¸å­¸ç¿’èˆ‡äº’å‹•ã€‚</p>

      <div id="auth-section">
        <button id="login-btn" onclick="window.location.href='login.html'">ç™»å…¥</button>
        <div id="user-info" class="hidden">
          <img id="user-photo" src="default-avatar.png" alt="é ­åƒ" class="avatar">
          <span id="user-name"></span>
          <button id="logout-btn">ç™»å‡º</button>
        </div>
      </div>

      <div id="comment-box" style="display:none;">
        <textarea id="comment-input" placeholder="è¼¸å…¥ç•™è¨€å…§å®¹..."></textarea>
        <button id="send-btn">é€å‡ºç•™è¨€</button>
      </div>

      <div id="comment-list" class="comment-list">
        <p>æ­£åœ¨è¼‰å…¥ç•™è¨€...</p>
      </div>
    </section>

    <p class="last-updated">ğŸ“… æœ€å¾Œæ›´æ–°ï¼š<span id="update-date"></span></p>
  </main>

  <button id="backToTop" title="å›åˆ°é ‚éƒ¨">â¬†</button>

  <footer>
    Â© 2025 å°å®å·¥ä½œå®¤<br>
    <a href="https://andrew.000.pe/privacy.html" target="_blank">éš±ç§æ¬Šæ”¿ç­–</a> | 
    <a href="terms.html" target="_blank">æœå‹™æ¢æ¬¾</a>
  </footer>

  <noscript>âš ï¸ æœ¬ç¶²ç«™éœ€è¦å•Ÿç”¨ JavaScript æ‰èƒ½æ­£å¸¸ä½¿ç”¨ç•™è¨€åŠŸèƒ½ã€‚</noscript>

  <!-- Firebase èˆ‡ç•™è¨€æ¿åŠŸèƒ½ -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
    import { getFirestore, collection, addDoc, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";
    import { firebaseConfig } from "./firebase.js";

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const loginBtn = document.getElementById('login-btn');
    const logoutBtn = document.getElementById('logout-btn');
    const userInfo = document.getElementById('user-info');
    const userPhoto = document.getElementById('user-photo');
    const userName = document.getElementById('user-name');
    const commentBox = document.getElementById('comment-box');
    const commentInput = document.getElementById('comment-input');
    const commentList = document.getElementById('comment-list');

    if (logoutBtn) {
      logoutBtn.addEventListener('click', () => {
        signOut(auth).then(() => location.reload()).catch(console.error);
      });
    }

    onAuthStateChanged(auth, (user) => {
      if (user) {
        loginBtn.style.display = 'none';
        userInfo.classList.remove('hidden');
        userName.textContent = user.displayName || user.email;
        userPhoto.src = user.photoURL || 'default-avatar.png';
        commentBox.style.display = 'block';
        loadComments();
      } else {
        loginBtn.style.display = 'inline-block';
        userInfo.classList.add('hidden');
        commentBox.style.display = 'none';
        loadComments();
      }
    });

    async function sendComment() {
      const content = commentInput.value.trim();
      const user = auth.currentUser;
      if (!user) { alert("è«‹å…ˆç™»å…¥å†ç•™è¨€ï¼"); return; }
      if (!content) { alert("è«‹è¼¸å…¥ç•™è¨€å…§å®¹ï¼"); return; }

      try {
        await addDoc(collection(db, "comments"), {
          text: content,
          user: user.email,
          time: new Date().toISOString()
        });
        commentInput.value = "";
        loadComments();
      } catch (err) {
        console.error("ç•™è¨€ç™¼é€å¤±æ•—ï¼š", err);
      }
    }

async function loadComments() {
  commentList.innerHTML = "<p>æ­£åœ¨è¼‰å…¥ç•™è¨€...</p>";
  const user = auth.currentUser;

  try {
    const q = query(collection(db, "comments"), orderBy("time", "desc"));
    const snapshot = await getDocs(q);

    if (snapshot.empty) { 
      commentList.innerHTML = "<p>ç›®å‰æ²’æœ‰ç•™è¨€ã€‚</p>"; 
      return; 
    }

    commentList.innerHTML = "";
    snapshot.forEach(doc => {
      const data = doc.data();
      const item = document.createElement("div");
      item.classList.add("comment-item");

      // ç•™è¨€æ–‡å­—èˆ‡ä½¿ç”¨è€…
      item.innerHTML = `<strong>${data.user}</strong><p>${data.text}</p><small>${new Date(data.time).toLocaleString()}</small>`;

      // å¦‚æœæ˜¯ç•™è¨€ä½œè€…ï¼Œé¡¯ç¤ºåˆªé™¤æŒ‰éˆ•
      if (user && user.email === data.user) {
        const deleteBtn = document.createElement("button");
        deleteBtn.textContent = "åˆªé™¤";
        deleteBtn.addEventListener("click", async () => {
          try {
            await db.collection("comments").doc(doc.id).delete();
            loadComments();
          } catch (err) {
            console.error("åˆªé™¤ç•™è¨€å¤±æ•—ï¼š", err);
          }
        });
        item.appendChild(deleteBtn);
      }

      commentList.appendChild(item);
    });
  } catch (err) {
    console.error("ç•™è¨€è¼‰å…¥å¤±æ•—ï¼š", err);
    commentList.innerHTML = "<p>ç•™è¨€è¼‰å…¥å¤±æ•—ã€‚</p>";
  }
}

    
  </script>

  <!-- å…¶ä»– JS -->
  <script src="theme.js"></script>
  <script src="badge.js"></script>
  <script src="type.js"></script>
  <script src="lan.js"></script>
  <script src="other.js"></script>
  <script src="er.js"></script>
</body>
</html>

