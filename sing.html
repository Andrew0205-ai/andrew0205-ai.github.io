<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ–°åŠ å¡å‹‡æ°£èƒ½é‡å°éŠæˆ²</title>
  <style>
    body {
      font-family: "Noto Sans TC", sans-serif;
      background: linear-gradient(135deg, #6d9eeb, #f1c232);
      min-height: 100vh;
      margin: 0;
      padding: 20px;
      color: #fff;
      text-align: center;
    }
    h1 { font-size: 32px; text-shadow: 2px 2px 6px rgba(0,0,0,0.3); }
    .progress-container {
      width: 80%; max-width: 400px; height: 28px;
      background: rgba(255,255,255,0.3); border-radius: 20px;
      margin: 20px auto; overflow: hidden;
    }
    .progress-bar {
      height: 100%; width: 0%; background: #f1c232;
      border-radius: 20px; transition: width 0.5s ease;
    }
    button { padding: 12px 24px; margin: 10px; border: none;
      border-radius: 12px; font-size: 18px; cursor: pointer; background: #fff; color: #333;
      transition: 0.2s;
    }
    button:hover { transform: scale(1.05); }
    #msg, #dateMsg, #countdown { margin-top: 20px; font-size: 20px; min-height: 30px; }
    #log { margin-top: 20px; max-height: 200px; overflow-y: auto; text-align: left; font-size: 16px; }
    #calendar { margin-top: 20px; }
    .day { display: inline-block; width: 32px; height: 32px; line-height: 32px; margin: 2px;
      text-align: center; background: rgba(255,255,255,0.3); border-radius: 6px; }
    .checked { background: #6d9eeb; }
  </style>
</head>
<body>
  <h1>ğŸŒŸ æ–°åŠ å¡å‹‡æ°£èƒ½é‡å°éŠæˆ² ğŸŒŸ</h1>

  <div id="countdown"></div>
  <div id="dateMsg"></div>

  <div>å‹‡æ°£ï¼š<span id="energy">0</span> / 1000</div>
  <div>ç­‰ç´šï¼š<span id="level">1</span></div>
  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>

  <button onclick="addEnergy()">å¢åŠ å‹‡æ°£åˆ†æ•¸</button>
  <button onclick="dailyCheckIn()">æ¯æ—¥ç°½åˆ° +5</button>

  <div id="msg"></div>

  <div id="calendar"></div>

  <h3>ç´€éŒ„åˆ—è¡¨ï¼š</h3>
  <div id="log"></div>

<script>
  // -------------------- åˆå§‹åŒ–å‹‡æ°£åˆ†æ•¸èˆ‡ç­‰ç´š --------------------
  let energy = parseInt(localStorage.getItem("energy")) || 0;
  let level = parseInt(localStorage.getItem("level")) || 1;
  let dailyCount = parseInt(localStorage.getItem("dailyCount")) || 0;
  const messages = [
    "åŠ æ²¹ï¼è€ƒè©¦æ²’æœ‰ä½ å²å®³ï¼",
    "æ˜Ÿå®ä»Šå¤©ä¹Ÿå¾ˆåŠªåŠ›äº†ï¼",
    "ä½ é›¢æ–°åŠ å¡æ›´è¿‘ä¸€æ­¥å•¦ âœ¨",
    "ç¹¼çºŒä¿æŒï¼Œä½ ä¸€å®šå¯ä»¥å®Œæˆæ‰€æœ‰æŒ‘æˆ°ï¼",
    "å¤ªæ£’äº†ï¼ä½ æ­£åœ¨å¾€1æœˆ29æ—¥å¤§æ­¥å‰é€²ï¼",
    "æ¯ä¸€æ¬¡åŠªåŠ›éƒ½æœƒè®“æœªä¾†æ›´å®¹æ˜“ã€‚"
  ];

  function saveEnergy() {
    localStorage.setItem("energy", energy);
    localStorage.setItem("level", level);
    localStorage.setItem("dailyCount", dailyCount);
  }

  function updateEnergyBar() {
    document.getElementById("energy").textContent = energy;
    document.getElementById("level").textContent = level;
    const percent = (energy/1000)*100;
    document.getElementById("progressBar").style.width = percent + "%";
  }

  function addEnergy() {
    const today = new Date().toDateString();
    if (dailyCount >= 5000) {
      document.getElementById("msg").textContent = "ä»Šå¤©å‹‡æ°£åˆ†æ•¸å·²é” 5000 æ¬¡ä¸Šé™ï¼æ˜å¤©å†åŠ å§ï¼";
      return;
    }
    dailyCount++;
    let add = prompt("è¼¸å…¥è¦å¢åŠ çš„å‹‡æ°£åˆ†æ•¸ï¼ˆ1~20000ï¼‰ï¼š");
    if (add === null) return;
    add = parseInt(add);
    if (isNaN(add) || add < 1) { alert("è«‹è¼¸å…¥æœ‰æ•ˆæ•¸å­—"); dailyCount--; return; }
    if (add > 20000) { alert("å–®æ¬¡æœ€å¤š 20000 åˆ†ï¼"); dailyCount--; return; }

    const record = confirm("ä½ è¦ç´€éŒ„é€™æ¬¡åŠ åˆ†äº‹ä»¶å—ï¼Ÿ");
    energy += add;
    if (energy >= 1000) {
      energy -= 1000;
      level++;
      alert(`ğŸ‰ æ­å–œå‡ç´šï¼ä½ ç¾åœ¨æ˜¯ Lv. ${level} ğŸ‰`);
    }
    saveEnergy();
    updateEnergyBar();

    if (record) {
      let description = prompt("è«‹è¼¸å…¥äº‹ä»¶æè¿°ï¼š");
      if (description) addLog(description, add);
    }

    document.getElementById("msg").textContent = messages[Math.floor(Math.random()*messages.length)];
  }

  // -------------------- æ—¥èªŒç´€éŒ„ --------------------
  let logData = JSON.parse(localStorage.getItem("logData")) || [];
  function addLog(desc, score){
    const now = new Date();
    const time = now.toLocaleDateString() + " " + now.getHours() + ":" + now.getMinutes();
    logData.unshift(`ğŸ“˜ ${time} ${desc} +${score}`);
    localStorage.setItem("logData", JSON.stringify(logData));
    renderLog();
  }
  function renderLog(){
    document.getElementById("log").innerHTML = logData.join("<br>");
  }
  renderLog();

  // -------------------- æ¯æ—¥ç°½åˆ° --------------------
  function dailyCheckIn(){
    const today = new Date().toDateString();
    const lastCheckIn = localStorage.getItem("checkinDate");
    if (lastCheckIn === today){
      document.getElementById("msg").textContent = "ä»Šå¤©å·²ç°½åˆ°éå›‰ï¼";
      return;
    }
    energy +=5;
    saveEnergy();
    updateEnergyBar();
    localStorage.setItem("checkinDate", today);
    document.getElementById("msg").textContent = "ç°½åˆ°æˆåŠŸ +5 å‹‡æ°£ï¼";
    renderCalendar();
  }

  // -------------------- è¾›è‹¦æ—¥å­ç™¾åˆ†æ¯” --------------------
  function calculateDateProgress(){
    const start = new Date("2025-11-01");
    const end = new Date("2026-01-29");
    const now = new Date();
    const total = end - start;
    const passed = now - start;
    let percent = (passed/total)*100;
    if (percent<0) percent=0;
    if (percent>100) percent=100;
    const passedPercent = percent.toFixed(1);
    const remainingPercent = (100-percent).toFixed(1);
    document.getElementById("dateMsg").textContent = `ä½ å¥½å²å®³ï¼Œå·²ç¶“éäº† ${passedPercent}% çš„è¾›è‹¦æ—¥å­ï¼Œé‚„æœ‰ ${remainingPercent}% å°±èƒ½åˆ°æ–°åŠ å¡äº†ï¼`;
  }

  // -------------------- å€’æ•¸å¤©æ•¸ --------------------
  function countdown(){
    const today = new Date();
    const target = new Date("2026-01-29");
    let days = Math.ceil((target-today)/(1000*60*60*24));
    if (days<0) days=0;
    document.getElementById("countdown").textContent = `ğŸ“… è·é›¢æ–°åŠ å¡ä¹‹æ—…é‚„æœ‰ ${days} å¤©ï¼`;
  }

  // -------------------- æ—¥æ›†ç°½åˆ° --------------------
  function renderCalendar(){
    const calendar = document.getElementById("calendar");
    calendar.innerHTML = "<h3>ç°½åˆ°æ—¥æ›†ï¼š</h3>";
    const today = new Date();
    const year = today.getFullYear();
    const month = today.getMonth();
    const start = new Date(year, month, 1);
    const end = new Date(year, month+1, 0);
    let html = "";
    for (let d=1; d<=end.getDate(); d++){
      const dateStr = new Date(year, month, d).toDateString();
      const checked = (localStorage.getItem("checkinDate") === dateStr) ? "checked" : "";
      html += `<div class="day ${checked}">${d}</div>`;
    }
    calendar.innerHTML += html;
  }

  // -------------------- åˆå§‹åŒ– --------------------
  updateEnergyBar();
  calculateDateProgress();
  countdown();
  renderCalendar();
</script>
</body>
</html>